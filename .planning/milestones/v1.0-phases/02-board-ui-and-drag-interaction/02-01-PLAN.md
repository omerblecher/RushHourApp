---
phase: 02-board-ui-and-drag-interaction
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - vite.config.ts
  - index.html
  - src/main.tsx
  - src/index.css
  - src/App.tsx
  - src/App.module.css
  - src/store/gameStore.ts
  - src/utils/vehicleColors.ts
  - src/components/Board/Board.tsx
  - src/components/Board/Board.module.css
  - src/components/Board/BoardCell.tsx
  - src/components/Board/BoardCell.module.css
  - src/components/Vehicle/Vehicle.tsx
  - src/components/Vehicle/Vehicle.module.css
autonomous: true

must_haves:
  truths:
    - "User sees a 6x6 grid board with visible cell tiles and a board border"
    - "User sees colorful pill-shaped vehicles with 3D shadows and pseudo-element details (windows, headlights for cars; cargo panels for trucks)"
    - "Exit marker is visible as a gap/cutout in the right border at row 3"
    - "Red target car (X) has special flair styling distinct from other vehicles"
    - "Board maintains square aspect ratio and renders from 320px viewport up to desktop"
    - "12+ distinct vehicle colors are available, red reserved for X"
  artifacts:
    - path: "src/store/gameStore.ts"
      provides: "Zustand store wrapping GameEngine"
      exports: ["useGameStore"]
    - path: "src/components/Board/Board.tsx"
      provides: "6x6 grid board with exit marker"
    - path: "src/components/Vehicle/Vehicle.tsx"
      provides: "CSS-styled vehicle chips"
    - path: "src/utils/vehicleColors.ts"
      provides: "Vehicle color palette mapping"
      exports: ["getVehicleColor"]
    - path: "vite.config.ts"
      provides: "Vite build configuration with React plugin"
    - path: "index.html"
      provides: "HTML entry point"
  key_links:
    - from: "src/App.tsx"
      to: "src/store/gameStore.ts"
      via: "useGameStore hook"
      pattern: "useGameStore"
    - from: "src/store/gameStore.ts"
      to: "src/engine/engine.ts"
      via: "GameEngine instance"
      pattern: "new GameEngine"
    - from: "src/components/Board/Board.tsx"
      to: "src/components/Vehicle/Vehicle.tsx"
      via: "renders Vehicle for each vehicle in state"
      pattern: "Vehicle"
    - from: "src/components/Vehicle/Vehicle.tsx"
      to: "src/utils/vehicleColors.ts"
      via: "getVehicleColor for CSS styling"
      pattern: "getVehicleColor"
---

<objective>
Scaffold the Vite + React 19 + Zustand front-end infrastructure and render a static (non-interactive) game board with CSS-styled vehicles, visible grid cells, an exit marker, and responsive layout.

Purpose: Establish the visual foundation that Plan 02-02 will make interactive with drag events. Users see a complete, polished game board even before drag is wired up.
Output: Running `npm run dev` shows a colorful 6x6 Rush Hour board with pill-shaped vehicles, grid cell tiles, exit gap, and responsive sizing.
</objective>

<execution_context>
@C:/Users/omerb/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/omerb/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-board-ui-and-drag-interaction/02-RESEARCH.md
@.planning/phases/02-board-ui-and-drag-interaction/02-CONTEXT.md
@src/engine/types.ts
@src/engine/index.ts
@src/engine/engine.ts
@src/engine/board.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Vite + React + Zustand infrastructure and game store</name>
  <files>
    package.json
    tsconfig.json
    vite.config.ts
    index.html
    src/main.tsx
    src/index.css
    src/App.tsx
    src/App.module.css
    src/store/gameStore.ts
    src/utils/vehicleColors.ts
  </files>
  <action>
**Install dependencies:**
```bash
npm install react@^19.0.0 react-dom@^19.0.0 zustand@^5.0.0
npm install --save-dev @vitejs/plugin-react @types/react@^19.0.0 @types/react-dom@^19.0.0 vite
```

**vite.config.ts:**
- Import `@vitejs/plugin-react` and configure with default settings
- Set `resolve.alias` for `@engine` pointing to `src/engine`
- Set `css.modules.localsConvention` to `camelCaseOnly`

**tsconfig.json updates:**
- Change `module` to `"ESNext"` and `moduleResolution` to `"Bundler"` for Vite compatibility
- Add `"jsx": "react-jsx"` for React 19 JSX transform
- Add `"types": ["vite/client"]` to compilerOptions
- Keep existing `@engine/*` path alias
- Update `include` to cover `*.tsx` files

**package.json updates:**
- Add `"type": "module"` (already using ESM for engine)
- Add scripts: `"dev": "vite"`, `"build": "vite build"`, `"preview": "vite preview"`
- Keep existing `"test"` and `"typecheck"` scripts

**index.html** (in project root, not src):
- Standard Vite HTML entry: `<!DOCTYPE html>`, viewport meta, `<div id="root">`, `<script type="module" src="/src/main.tsx">`
- Title: "Rush Hour"

**src/main.tsx:**
- Import React 19 `createRoot` from `react-dom/client`
- Import `App` and `./index.css`
- Render `<App />` into `#root`

**src/index.css:**
- CSS reset: `*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }`
- `body` font: `system-ui, -apple-system, sans-serif`
- Background: warm light color (e.g., `#f5f0e8`) with subtle dot pattern using `radial-gradient` — per user decision for subtle pattern/texture behind the grid
- `#root` centered with `min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;`

**src/App.tsx:**
- Import `useGameStore` from store
- Hardcode ONE test puzzle for Phase 2 dev: `"AA...O..XXBOO...B....CCDD.."` (or a known valid 36-char grid string with multiple vehicles — verify X is on row 2). Call `useGameStore.getState().loadPuzzle(gridString)` on mount via useEffect
- Render `<Board />` component
- Wrap in a container div with App.module.css styling

**src/App.module.css:**
- `.app` container: center children, padding for mobile safety

**src/store/gameStore.ts — Zustand store wrapping GameEngine:**
- Create store with `zustand/vanilla` `createStore` + React hook via `useStore`
- Store state interface: `{ engine: GameEngine | null; state: GameState | null; minMoves: number; loadPuzzle: (grid: string, minMoves?: number) => void; move: (vehicleId: string, newRow: number, newCol: number) => MoveResult | null; undo: () => MoveResult | null; reset: () => void; }`
- `loadPuzzle`: creates new `GameEngine(grid)`, snapshots state via `engine.getState()`
- `move`: delegates to `engine.move()`, updates state snapshot
- `undo`: delegates to `engine.undo()`, updates state snapshot
- `reset`: delegates to `engine.reset()`, updates state snapshot
- Export `useGameStore` hook with selector support for fine-grained re-renders
- Engine instance is NOT stored in React state — it's a stable reference in the store closure

**src/utils/vehicleColors.ts:**
- Map of vehicle ID character to CSS color object `{ bg: string; border: string; shadow: string }`
- 'X' (target car) = red `#e53935` with a subtle glow/accent
- At least 12 other colors: blue `#1e88e5`, green `#43a047`, yellow `#fdd835`, purple `#8e24aa`, orange `#fb8c00`, teal `#00897b`, pink `#d81b60`, indigo `#3949ab`, lime `#7cb342`, cyan `#00acc1`, brown `#6d4c41`, amber `#ffb300`
- Each entry has a slightly darker `border` and appropriate `shadow` value
- Export `getVehicleColor(id: string)` — returns the mapped color or a fallback gray
- Rainbow palette per user decision
  </action>
  <verify>
Run `npm run dev` — Vite dev server starts without errors. Run `npx tsc --noEmit` (may have minor issues before components exist — that's OK, store and utils should compile).
  </verify>
  <done>
Vite dev server launches, React renders the App shell, gameStore creates a GameEngine from a hardcoded puzzle, vehicleColors provides 12+ distinct colors with red reserved for X.
  </done>
</task>

<task type="auto">
  <name>Task 2: Board grid, Vehicle chips with CSS art, and exit marker</name>
  <files>
    src/components/Board/Board.tsx
    src/components/Board/Board.module.css
    src/components/Board/BoardCell.tsx
    src/components/Board/BoardCell.module.css
    src/components/Vehicle/Vehicle.tsx
    src/components/Vehicle/Vehicle.module.css
  </files>
  <action>
**src/components/Board/BoardCell.tsx:**
- Simple div with `BoardCell.module.css` class
- Props: `{ row: number; col: number }` (for potential future use)
- Renders a single grid cell tile

**src/components/Board/BoardCell.module.css:**
- `.cell` — visible tile with slight border or alternating shade (per user decision: "distinct cell tiles")
- Light background (e.g., `#e8e0d0`), subtle `1px` border or `box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08)`
- `border-radius: 2px` for subtle rounded cell corners
- `aspect-ratio: 1/1` to stay square within the grid

**src/components/Board/Board.tsx:**
- Read `state` from `useGameStore` (the GameState snapshot)
- Render a board container div with:
  - A 6x6 CSS Grid of `<BoardCell />` components (36 cells)
  - Vehicle components absolutely positioned over the grid using percentage-based positioning
  - An exit marker div positioned on the right side at row 3 (row index 2)
- Board container sizing: `width: min(90vw, 90vh, 480px)` with `aspect-ratio: 1/1` — per research
- For each vehicle in `state.vehicles`, render a `<Vehicle />` passing vehicle data and computed position
- Vehicle position calculation: `left: (col / 6) * 100%`, `top: (row / 6) * 100%`, `width: (size / 6) * 100%` for horizontal (or `height` for vertical)
- Board has a visible wooden/dark border (like a board game frame) — `box-shadow` or thick `border` with rounded corners
- Exit marker: a child div positioned absolutely at `right: -8px` (overlapping the border), `top: calc((2/6) * 100%)`, `height: calc((1/6) * 100%)`, with background matching the page background color so it looks like a gap/cutout in the board border — per user decision mirroring the physical Rush Hour game

**src/components/Board/Board.module.css:**
- `.board` — position: relative, background dark wood color (e.g., `#5d4037`), border-radius 12px, padding 8px (the frame), box-shadow for depth
- `.gridContainer` — display: grid, grid-template-columns: repeat(6, 1fr), gap: 2px, position: relative, border-radius: 8px, overflow: hidden, background for gap color
- `.vehicleLayer` — position: absolute, inset over the grid area (accounting for padding), pointer-events: none on container (individual vehicles get pointer-events: auto)
- `.exitMarker` — position: absolute, right edge, row 3 height, background matching page bg, z-index above board border
- Responsive: `width: min(90vw, 90vh, 480px)` on the outermost board wrapper

**src/components/Vehicle/Vehicle.tsx:**
- Props: `{ vehicle: Vehicle; cellSize: number }` (Vehicle type from engine) — though actual positioning is percentage-based
- Actually, props: `{ vehicle: Vehicle; boardSize: number }` or just compute from CSS percentages
- Better: props `{ vehicle: Vehicle }` — positioning computed as inline style percentages
- Uses `getVehicleColor(vehicle.id)` for colors
- Container div with inline style: `position: absolute; left; top; width; height` (percentage-based from vehicle position/size/orientation)
- Apply CSS classes from Vehicle.module.css for visual styling
- Add `data-vehicle-id={vehicle.id}` attribute for drag system to use later
- Add `data-orientation={vehicle.orientation}` attribute
- `touch-action: none` in CSS (CRITICAL: must be in static CSS before pointerdown fires — per research pitfall)
- `pointer-events: auto` (container layer has none)
- `will-change: transform` ONLY added dynamically during drag (not in static CSS — per research pitfall about GPU memory)

**src/components/Vehicle/Vehicle.module.css:**
Per user decisions: "Very rounded, 3D-ish shapes — pill-shaped with shadows and gradients, like physical toy pieces"

- `.vehicle` — border-radius: 12px (pill-like), cursor: grab, user-select: none, touch-action: none, position: absolute, transition: none (NO transition in default — only added on snap, per research pitfall)
- Background: linear-gradient using vehicle color (lighter top to darker bottom for 3D effect)
- Box-shadow: `0 3px 6px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.3)` for 3D depth
- Border: 2px solid using vehicle's border color (slightly darker than bg)
- `.vehicle::before` — pseudo-element for car windows/headlights:
  - For horizontal 2-cell cars: two small rounded rectangles (windows) using `background` with gradient
  - Use content: '', position: absolute, sized as small circles/rounded-rects
- `.vehicle::after` — pseudo-element for additional details:
  - Headlight dots or bumper line
- `.truck` modifier class (applied when size === 3):
  - `::before` shows cargo panel lines instead of windows
  - `::after` shows different truck details (e.g., wider panel)
- `.targetCar` modifier class (applied when id === 'X'):
  - Extra flair per user decision: subtle pulsing glow via box-shadow animation, or a star/shine effect
  - Slightly brighter/more vibrant than regular red
  - Could add a subtle CSS keyframe shine animation (a diagonal light sweep across the surface)
- `.horizontal` and `.vertical` modifier classes to orient pseudo-element details correctly

NOTE on pseudo-elements: The exact visual details are at Claude's discretion. The key requirement is that cars (2-cell) look different from trucks (3-cell), and the red target car stands out. Use `::before` and `::after` creatively — windows as rounded white/light semi-transparent shapes, headlights as small dots, truck cargo as horizontal lines. Vertical vehicles should rotate the details 90 degrees.
  </action>
  <verify>
Run `npm run dev` — browser shows a 6x6 board with visible grid cells, a dark border/frame, an exit gap on the right at row 3, and colorful pill-shaped vehicles positioned correctly on the grid. Vehicles should look 3D with shadows and gradients. The red car (X) should have a visible special effect. Resize browser to 320px width — board should shrink responsively while staying square. Run `npx tsc --noEmit` — no type errors.
  </verify>
  <done>
Board renders with 36 visible cell tiles in a 6x6 grid, a board-game-style border with exit gap at row 3, vehicles styled as colorful pill-shaped pieces with pseudo-element details (windows for cars, panels for trucks), red target car has special flair, and the board is responsive from 320px to desktop maintaining square aspect ratio.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts Vite dev server without errors
2. Browser shows a 6x6 game board with visible grid cell tiles
3. Vehicles are colorful, pill-shaped, with 3D shadows and gradients
4. Cars (2-cell) have window/headlight pseudo-element details
5. Trucks (3-cell) have cargo/panel pseudo-element details
6. Red target car (X) has special flair (glow, shine, or accent)
7. Exit marker visible as gap/cutout on right border at row 3
8. Board has a dark border resembling a board game frame
9. Resize to 320px viewport width — board shrinks responsively, stays square
10. `npx tsc --noEmit` passes with no type errors
11. 12+ distinct vehicle colors visible (red reserved for X)
</verification>

<success_criteria>
A visually complete, non-interactive Rush Hour board renders in the browser with all visual design requirements met. The board is responsive and all CSS vehicle details render without image assets. The Zustand store correctly wraps the GameEngine and exposes state.
</success_criteria>

<output>
After completion, create `.planning/phases/02-board-ui-and-drag-interaction/02-01-SUMMARY.md`
</output>
